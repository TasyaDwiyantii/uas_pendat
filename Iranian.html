
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Analisis dan Implementasi Klasifikasi Churn Pelanggan pada Perusahaan Telekomunikasi Iranian &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Iranian';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FIranian.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Iranian.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1. Analisis dan Implementasi Klasifikasi Churn Pelanggan pada Perusahaan Telekomunikasi Iranian</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1. Analisis dan Implementasi Klasifikasi Churn Pelanggan pada Perusahaan Telekomunikasi Iranian</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-dalam-bidang-analisis-data-telekomunikasi">Tujuan dalam Bidang Analisis Data Telekomunikasi</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konteks-penelitian">Konteks Penelitian</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">2. Data Understanding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pengumpulan-data">Pengumpulan Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mencari-dataset">Mencari Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengambil-dan-menampilkan-dataset">Mengambil dan Menampilkan Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memahami-data">Memahami Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">Eksplorasi Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumlah-data-fitur-dan-tipe-data">Jumlah Data Fitur dan Tipe Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumlah-data-dari-dataset-iranian-churn">Jumlah Data dari Dataset Iranian Churn</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumlah-class-atau-kategori-pada-data-iranian-churn">Jumlah Class atau Kategori pada Data Iranian Churn</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deskripsi-dataset">Deskripsi Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifikasi-kualitas-data">Identifikasi Kualitas Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-data-missing-values">1. Deteksi Data Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-data-outlier">2. Deteksi Data Outlier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-duplikasi-dataset">3. Deteksi Duplikasi Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prepocessing-data">3. Prepocessing Data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">4. Modelling</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-metode-klasifikasi-naive-bayes">Implementasi Metode Klasifikasi Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membagi-data-train-dan-data-test">Membagi Data Train dan Data Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melakukan-prediksi-dengan-sklearn-naive-bayes">Melakukan Prediksi dengan Sklearn Naive Bayes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-learning">Ensemble Learning</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-classifier-meta-classifier">Stacking Classifier (Meta Classifier)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-meta-predict-classifier-model-naive-bayes-manual">A. Meta Predict Classifier Model Naive Bayes Manual</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-p1">Model P1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-p2">Model P2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bagging">Bagging</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#kesimpulan">Kesimpulan</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-model">Implementasi Model</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-web">Implementasi Web</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hasil-implementasi-web">Hasil Implementasi Web</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-dan-implementasi-klasifikasi-churn-pelanggan-pada-perusahaan-telekomunikasi-iranian">
<h1>1. Analisis dan Implementasi Klasifikasi Churn Pelanggan pada Perusahaan Telekomunikasi Iranian<a class="headerlink" href="#analisis-dan-implementasi-klasifikasi-churn-pelanggan-pada-perusahaan-telekomunikasi-iranian" title="Link to this heading">#</a></h1>
<p>Link menuju website yang sudah saya buat atau hosting : <a class="reference external" href="http://tasyadwiyanti.pythonanywhere.com/">http://tasyadwiyanti.pythonanywhere.com/</a></p>
<section id="tujuan-dalam-bidang-analisis-data-telekomunikasi">
<h2>Tujuan dalam Bidang Analisis Data Telekomunikasi<a class="headerlink" href="#tujuan-dalam-bidang-analisis-data-telekomunikasi" title="Link to this heading">#</a></h2>
<p>Analisis dataset ini bertujuan untuk membangun model klasifikasi yang dapat memprediksi perilaku churn pelanggan.</p>
<p>tujuan utama dari analisis dan implementasi klasifikasi, yaitu untuk meningkatkan pemahaman terhadap perilaku churn pelanggan dan mengimplementasikan model prediksi untuk membantu perusahaan telekomunikasi di Iranian dalam mempertahankan pelanggan mereka dengan lebih efektif.</p>
<ol class="arabic simple">
<li><p>Mengidentifikasi Faktor-faktor Churn: Tujuan utama adalah mengidentifikasi faktor-faktor yang berkontribusi terhadap keputusan pelanggan untuk berhenti berlangganan (churn). Ini dapat meliputi analisis terhadap variabel seperti jumlah keluhan, frekuensi penggunaan layanan, jenis layanan, dan karakteristik pelanggan lainnya.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Mengembangkan Model Prediksi: Membangun model klasifikasi yang dapat memprediksi kemungkinan churn pelanggan berdasarkan data historis. Model ini dapat menggunakan algoritma machine learning seperti Decision Tree, Random Forest, atau Logistic Regression untuk memperoleh prediksi yang akurat.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Optimasi Strategi Retensi: Memanfaatkan hasil analisis dan prediksi churn untuk merancang strategi retensi yang lebih efektif. Strategi ini bisa meliputi penawaran khusus, pelayanan pelanggan yang lebih baik, atau pengembangan produk yang lebih menarik.</p></li>
</ol>
<p>Manfaat :</p>
<ol class="arabic simple">
<li><p>Meningkatkan Retensi Pelanggan: Dengan memahami faktor-faktor yang menyebabkan churn, perusahaan telekomunikasi dapat mengambil langkah-langkah proaktif untuk mempertahankan pelanggan yang ada.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Optimasi Sumber Daya: Menggunakan analisis data untuk mengoptimalkan alokasi sumber daya, termasuk investasi dalam layanan pelanggan, pemasaran, dan pengembangan produk.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Peningkatan Kinerja Bisnis: Dengan mengurangi churn, perusahaan dapat meningkatkan pendapatan dan profitabilitas mereka, karena mempertahankan pelanggan yang sudah ada seringkali lebih efisien daripada mendapatkan pelanggan baru.</p></li>
</ol>
<p>Ini tidak hanya bertujuan untuk memahami perilaku pelanggan dalam konteks churn, tetapi juga untuk memberikan kontribusi yang signifikan dalam meningkatkan strategi bisnis dan operasional perusahaan telekomunikasi di Iranian.</p>
</section>
<section id="konteks-penelitian">
<h2>Konteks Penelitian<a class="headerlink" href="#konteks-penelitian" title="Link to this heading">#</a></h2>
<p>Industri telekomunikasi di Iran menghadapi tantangan signifikan dalam mempertahankan pelanggan di tengah persaingan yang ketat dan perubahan perilaku konsumen. Masalah churn pelanggan, yaitu keputusan pelanggan untuk berhenti berlangganan layanan, menjadi fokus utama perusahaan-perusahaan telekomunikasi untuk meningkatkan retensi dan kepuasan pelanggan. Analisis ini bertujuan untuk menganalisis faktor-faktor yang mempengaruhi churn pelanggan dan mengimplementasikan model klasifikasi untuk memprediksi perilaku churn ini.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-understanding">
<h1>2. Data Understanding<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h1>
<p>Pada tahap ini, penting untuk memahami secara mendalam tentang dataset yang digunakan dalam analisis ini. Dataset ini merupakan kumpulan data yang diperoleh dari sebuah perusahaan telekomunikasi di Iranian, mencakup informasi dari 3150 pelanggan selama periode 12 bulan. Setiap baris dalam dataset mewakili satu pelanggan dan terdiri dari 13 atribut yang relevan dalam menganalisis perilaku pelanggan terkait keputusan churn.</p>
<section id="pengumpulan-data">
<h2>Pengumpulan Data<a class="headerlink" href="#pengumpulan-data" title="Link to this heading">#</a></h2>
<section id="mencari-dataset">
<h3>Mencari Dataset<a class="headerlink" href="#mencari-dataset" title="Link to this heading">#</a></h3>
<p>Langkah pertama pada pengumpulan data adalah dengan mencari dataset yang akan saya gunakan, sesuai penjelasan diatas saya menggunakan dataset Iranian Churn yang bersumber dari UCI Dataset : <a class="reference external" href="https://archive.ics.uci.edu/dataset/563/iranian+churn+dataset">https://archive.ics.uci.edu/dataset/563/iranian+churn+dataset</a></p>
</section>
<section id="mengambil-dan-menampilkan-dataset">
<h3>Mengambil dan Menampilkan Dataset<a class="headerlink" href="#mengambil-dan-menampilkan-dataset" title="Link to this heading">#</a></h3>
<p>Langkah selanjutnya yaitu menampilkan atau mengambil dataset tersebut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ucimlrepo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting ucimlrepo
  Downloading ucimlrepo-0.0.7-py3-none-any.whl (8.0 kB)
Requirement already satisfied: pandas&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ucimlrepo) (2.0.3)
Requirement already satisfied: certifi&gt;=2020.12.5 in /usr/local/lib/python3.10/dist-packages (from ucimlrepo) (2024.6.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2023.4)
Requirement already satisfied: tzdata&gt;=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2024.1)
Requirement already satisfied: numpy&gt;=1.21.0 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (1.25.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;ucimlrepo) (1.16.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing collected packages: ucimlrepo
Successfully installed ucimlrepo-0.0.7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
  
<span class="c1"># Mengambil dataset Iranian Churn dari UCI Repository</span>
<span class="n">iranian_churn</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">563</span><span class="p">)</span> 

<span class="c1"># Menampilkan metadata dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Metadata:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iranian_churn</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Menampilkan informasi variabel (fitur dan target)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Informasi Variabel:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iranian_churn</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>

<span class="c1"># Memisahkan fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iranian_churn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">iranian_churn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 
  
<span class="c1"># Contoh untuk menunjukkan bagaimana mengakses X dan y:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh data fitur (X):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh data target (y):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">())</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Metadata:
{&#39;uci_id&#39;: 563, &#39;name&#39;: &#39;Iranian Churn&#39;, &#39;repository_url&#39;: &#39;https://archive.ics.uci.edu/dataset/563/iranian+churn+dataset&#39;, &#39;data_url&#39;: &#39;https://archive.ics.uci.edu/static/public/563/data.csv&#39;, &#39;abstract&#39;: &quot;This dataset is randomly collected from an Iranian telecom company&#39;s database over a period of 12 months.&quot;, &#39;area&#39;: &#39;Business&#39;, &#39;tasks&#39;: [&#39;Classification&#39;, &#39;Regression&#39;], &#39;characteristics&#39;: [&#39;Multivariate&#39;], &#39;num_instances&#39;: 3150, &#39;num_features&#39;: 13, &#39;feature_types&#39;: [&#39;Integer&#39;], &#39;demographics&#39;: [&#39;Age&#39;], &#39;target_col&#39;: [&#39;Churn&#39;], &#39;index_col&#39;: None, &#39;has_missing_values&#39;: &#39;no&#39;, &#39;missing_values_symbol&#39;: None, &#39;year_of_dataset_creation&#39;: 2020, &#39;last_updated&#39;: &#39;Sat Mar 09 2024&#39;, &#39;dataset_doi&#39;: &#39;10.24432/C5JW3Z&#39;, &#39;creators&#39;: [], &#39;intro_paper&#39;: None, &#39;additional_info&#39;: {&#39;summary&#39;: &#39;This dataset is randomly collected from an Iranian telecom companyâ€™s database over a period of 12 months. A total of 3150 rows of data, each representing a customer, bear information for 13 columns. The attributes that are in this dataset\r\nare call failures, frequency of SMS, number of complaints, number of distinct calls, subscription length, age group, the charge amount, type of service, seconds of use, status, frequency of use, and Customer Value.\r\n\r\nAll of the attributes except for attribute churn is the aggregated data of the first 9 months. The churn labels are the state of the customers at the end of 12 months. The three months is the designated planning gap.&#39;, &#39;purpose&#39;: None, &#39;funded_by&#39;: None, &#39;instances_represent&#39;: None, &#39;recommended_data_splits&#39;: None, &#39;sensitive_data&#39;: None, &#39;preprocessing_description&#39;: None, &#39;variable_info&#39;: &#39;Anonymous Customer ID\r\nCall Failures: number of call failures\r\nComplains: binary (0: No complaint, 1: complaint)\r\nSubscription Length: total months of subscription\r\nCharge Amount: Ordinal attribute (0: lowest amount, 9: highest amount)\r\nSeconds of Use: total seconds of calls\r\nFrequency of use: total number of calls\r\nFrequency of SMS: total number of text messages\r\nDistinct Called Numbers: total number of distinct phone calls \r\nAge Group: ordinal attribute (1: younger age, 5: older age)\r\nTariff Plan: binary (1: Pay as you go, 2: contractual)\r\nStatus: binary (1: active, 2: non-active)\r\nChurn: binary (1: churn, 0: non-churn) - Class label\r\nCustomer Value: The calculated value of customer&#39;, &#39;citation&#39;: None}}

Informasi Variabel:
                       name     role        type demographic description  \
0             Call  Failure  Feature     Integer        None        None   
1                 Complains  Feature      Binary        None        None   
2      Subscription  Length  Feature     Integer        None        None   
3            Charge  Amount  Feature     Integer        None        None   
4            Seconds of Use  Feature     Integer        None        None   
5          Frequency of use  Feature     Integer        None        None   
6          Frequency of SMS  Feature     Integer        None        None   
7   Distinct Called Numbers  Feature     Integer        None        None   
8                 Age Group  Feature     Integer         Age        None   
9               Tariff Plan  Feature     Integer        None        None   
10                   Status  Feature      Binary        None        None   
11                      Age  Feature     Integer         Age        None   
12           Customer Value  Feature  Continuous        None        None   
13                    Churn   Target      Binary        None        None   

   units missing_values  
0   None             no  
1   None             no  
2   None             no  
3   None             no  
4   None             no  
5   None             no  
6   None             no  
7   None             no  
8   None             no  
9   None             no  
10  None             no  
11  None             no  
12  None             no  
13  None             no  

Contoh data fitur (X):
   Call  Failure  Complains  Subscription  Length  Charge  Amount  \
0              8          0                    38               0   
1              0          0                    39               0   
2             10          0                    37               0   
3             10          0                    38               0   
4              3          0                    38               0   

   Seconds of Use  Frequency of use  Frequency of SMS  \
0            4370                71                 5   
1             318                 5                 7   
2            2453                60               359   
3            4198                66                 1   
4            2393                58                 2   

   Distinct Called Numbers  Age Group  Tariff Plan  Status  Age  \
0                       17          3            1       1   30   
1                        4          2            1       2   25   
2                       24          3            1       1   30   
3                       35          1            1       1   15   
4                       33          1            1       1   15   

   Customer Value  
0         197.640  
1          46.035  
2        1536.520  
3         240.020  
4         145.805  

Contoh data target (y):
   Churn
0      0
1      0
2      0
3      0
4      0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>ucimlrepo
<span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
  
<span class="n">iranian_churn</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">563</span><span class="p">)</span> 
  
<span class="c1"># data (as pandas dataframes) </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iranian_churn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">iranian_churn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 

<span class="n">df_iranian_churn</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;iranian.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#variable features</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_iranian_churn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: ucimlrepo in /usr/local/lib/python3.10/dist-packages (0.0.7)
Requirement already satisfied: pandas&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ucimlrepo) (2.0.3)
Requirement already satisfied: certifi&gt;=2020.12.5 in /usr/local/lib/python3.10/dist-packages (from ucimlrepo) (2024.6.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2023.4)
Requirement already satisfied: tzdata&gt;=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2024.1)
Requirement already satisfied: numpy&gt;=1.21.0 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (1.25.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;ucimlrepo) (1.16.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Call  Failure  Complains  Subscription  Length  Charge  Amount  \
0                 8          0                    38               0   
1                 0          0                    39               0   
2                10          0                    37               0   
3                10          0                    38               0   
4                 3          0                    38               0   
...             ...        ...                   ...             ...   
3145             21          0                    19               2   
3146             17          0                    17               1   
3147             13          0                    18               4   
3148              7          0                    11               2   
3149              8          1                    11               2   

      Seconds of Use  Frequency of use  Frequency of SMS  \
0               4370                71                 5   
1                318                 5                 7   
2               2453                60               359   
3               4198                66                 1   
4               2393                58                 2   
...              ...               ...               ...   
3145            6697               147                92   
3146            9237               177                80   
3147            3157                51                38   
3148            4695                46               222   
3149            1792                25                 7   

      Distinct Called Numbers  Age Group  Tariff Plan  Status  Age  \
0                          17          3            1       1   30   
1                           4          2            1       2   25   
2                          24          3            1       1   30   
3                          35          1            1       1   15   
4                          33          1            1       1   15   
...                       ...        ...          ...     ...  ...   
3145                       44          2            2       1   25   
3146                       42          5            1       1   55   
3147                       21          3            1       1   30   
3148                       12          3            1       1   30   
3149                        9          3            1       1   30   

      Customer Value  Churn  
0            197.640      0  
1             46.035      0  
2           1536.520      0  
3            240.020      0  
4            145.805      0  
...              ...    ...  
3145         721.980      0  
3146         261.210      0  
3147         280.320      0  
3148        1077.640      0  
3149         100.680      1  

[3150 rows x 14 columns]
</pre></div>
</div>
</div>
</div>
<p>Kode tersebut digunakan untuk mengambil dataset “Iranian Churn” dari UCI Machine Learning Repository, memisahkan fitur-fiturnya dengan target variabelnya, menggabungkan menjadi satu dataframe, dan menyimpannya dia file csv, kemudian dicetak. Data tersebut akan digunakan untuk di analisis. Sebelum ke tahap selanjutnya atau sebelum di proses kita harus paham terlebih dahulu datasetnya yang memiliki tujuan untuk membangun model klasifikasi yang dapat memprediksi perilaku churn pelanggan.</p>
</section>
<section id="memahami-data">
<h3>Memahami Data<a class="headerlink" href="#memahami-data" title="Link to this heading">#</a></h3>
<p>Deskripsi penjelasan dataset, Dataset “Iranian Churn” dari UCI Machine Learning Repository terdiri dari 3150 instance dengan 13 atribut input (fitur) yang mencakup Call  Failure, Complains, Subscription  Length, Charge  Amount, Seconds of Use, Frequency of use, Frequency of SMS, Distinct Called Numbers, Age Group, Tariff Plan, Status, Age, dan Customer Value. Atribut ini bertipe data numerik. Selain itu, terdapat 1 atribut output (target atau kelas) yaitu Churn, yang memiliki 2 nilai kelas: 0 dan 1.
Dengan menggunakan data yang dikumpulkan selama 9 bulan pertama, tujuan utama adalah mengembangkan model klasifikasi yang dapat memprediksi perilaku churn pelanggan dan menyediakan wawasan yang berguna bagi perusahaan dalam meningkatkan strategi retensi pelanggan mereka.</p>
<p>Fitur-fitur dan class dataset :</p>
<ol class="arabic simple">
<li><p>Call Failure : Jumlah kegagalan panggilan yan dialami oleh pelanggan. (tipet data: numerik)</p></li>
<li><p>Complains : Variabel biner yang menunjukkan apakah pelanggan pernah mengajukan keluhan (0 : tidak ada keluhan, 1 : ada keluhan). (tipet data: numerik)</p></li>
<li><p>Subscription Lenght : Total bulan berlangganan pelanggan pada saat data dikumpulkan. (tipet data: numerik)</p></li>
<li><p>Charge Amount : Atribut ordinal yang menunjukkan tingkat biaya yang dikenakan kepada pelanggan ( 0 : biata terendah, 9 : biaya tertinggi). (tipet data: numerik)</p></li>
<li><p>Seconds of Use : Total durasi panggilan yang digunakan oleh pelanggan dalam detik. (tipet data: numerik)</p></li>
<li><p>Frequency of Use : Total jumlah panggilan yang dilakukan oleh pelanggan. (tipet data: numerik)</p></li>
<li><p>Frequency of SMS : Total jumlah pesan teks yang dikirim oleh pelanggan. (tipet data: numerik) (tipet data: numerik)</p></li>
<li><p>Distinct Called Numbers :  Jumlah total nomor telepon yang berbeda yang dihubungi oleh pelanggan. (tipet data: numerik)</p></li>
<li><p>Age Group : Atribut ordinal yang mengelompokkan pelanggan berdasarkan rentang usia (1 : usia lebih muda, 5 : usia lebih tua). (tipet data: numerik)</p></li>
<li><p>Tariff Plan :  Variabel biner yang menunjukkan jenis rencana tarif yang digunakan oleh pelanggan ( 1 : pay as you go, 2 : kontraktual). (tipet data: numerik)</p></li>
<li><p>Status : Variabel biner yang menunjukkan status pelanggan pada saat data dikumpulkan ( 1 : aktif, 2 : tidak aktif). (tipet data: numerik)</p></li>
<li><p>Age : Usia pelanggan dalam tahun. (tipet data: numerik)</p></li>
<li><p>Customer Value :  Nilai yang dihitung untuk pelanggan berdasarkan berbagai faktor seperti penggunaan layanan dan biaya yang dikeluarkan. (tipet data: numerik)</p></li>
<li><p>Churn :  Variabel target yang menunjukkan apakah pelanggan berhenti berlangganan setelah 12 bulan ( 1 : churn, 0 : tidak churn). (tipet data: numerik)</p></li>
</ol>
<p>Dataset ini terdiri dari data yang diambil dari 9 bulan pertama (agregat untuk atribut-atribut kecuali churn), dengan label churn diambil dari status pelanggan pada bulan ke-12. Adanya “planning gap” selama 3 bulan memungkinkan analisis prediktif untuk mengevaluasi faktor-faktor yang mempengaruhi keputusan churn pelanggan.</p>
</section>
</section>
<section id="eksplorasi-data">
<h2>Eksplorasi Data<a class="headerlink" href="#eksplorasi-data" title="Link to this heading">#</a></h2>
<p>Dataset “Iranian Churn” dari UCI Machine Learning Repository terdiri dari 3150 instance dengan 13 atribut input (fitur) yang mencakup Call  Failure, Complains, Subscription  Length, Charge  Amount, Seconds of Use, Frequency of use, Frequency of SMS, Distinct Called Numbers, Age Group, Tariff Plan, Status, Age, dan Customer Value. Atribut ini bertipe data numerik. Selain itu, terdapat 1 atribut output (target atau kelas) yaitu Churn, yang memiliki 2 nilai kelas: 0 dan 1.</p>
<section id="jumlah-data-fitur-dan-tipe-data">
<h3>Jumlah Data Fitur dan Tipe Data<a class="headerlink" href="#jumlah-data-fitur-dan-tipe-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3150 entries, 0 to 3149
Data columns (total 14 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   Call  Failure            3150 non-null   int64  
 1   Complains                3150 non-null   int64  
 2   Subscription  Length     3150 non-null   int64  
 3   Charge  Amount           3150 non-null   int64  
 4   Seconds of Use           3150 non-null   int64  
 5   Frequency of use         3150 non-null   int64  
 6   Frequency of SMS         3150 non-null   int64  
 7   Distinct Called Numbers  3150 non-null   int64  
 8   Age Group                3150 non-null   int64  
 9   Tariff Plan              3150 non-null   int64  
 10  Status                   3150 non-null   int64  
 11  Age                      3150 non-null   int64  
 12  Customer Value           3150 non-null   float64
 13  Churn                    3150 non-null   int64  
dtypes: float64(1), int64(13)
memory usage: 344.7 KB
</pre></div>
</div>
</div>
</div>
<p>Dari hasil output code tersebut, terdapat 3150 data, dan memiliki 13 fitur dan 1 class, pada code tersebut juga terdapat tipe datanya</p>
</section>
<section id="jumlah-data-dari-dataset-iranian-churn">
<h3>Jumlah Data dari Dataset Iranian Churn<a class="headerlink" href="#jumlah-data-dari-dataset-iranian-churn" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_data</span> <span class="o">=</span> <span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data dalam dataset iranian_churn:&quot;</span><span class="p">,</span> <span class="n">num_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data dalam dataset iranian_churn: 3150
</pre></div>
</div>
</div>
</div>
<p>Jumlah data dalam dataset Iranian Churn yaitu 3150</p>
</section>
<section id="jumlah-class-atau-kategori-pada-data-iranian-churn">
<h3>Jumlah Class atau Kategori pada Data Iranian Churn<a class="headerlink" href="#jumlah-class-atau-kategori-pada-data-iranian-churn" title="Link to this heading">#</a></h3>
<p>Saya akan melakukan pengecekan terhadap data Iranian Churn, ada berapa data dari masing-masing class atau kategori.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Churn&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Churn
0    2655
1     495
dtype: int64
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple">
<li><p>Churn 0 = 2655 Data Record.</p></li>
<li><p>Churn 1 = 495 Data Record.</p></li>
</ol>
</section>
<section id="deskripsi-dataset">
<h3>Deskripsi Dataset<a class="headerlink" href="#deskripsi-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Deskripsi Dari Datasets iranian_churn</span>
<span class="n">des</span> <span class="o">=</span> <span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Deskripsi Data Iranian Churn:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">des</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Deskripsi Data Iranian Churn:
       Call  Failure    Complains  Subscription  Length  Charge  Amount  \
count    3150.000000  3150.000000           3150.000000     3150.000000   
mean        7.627937     0.076508             32.541905        0.942857   
std         7.263886     0.265851              8.573482        1.521072   
min         0.000000     0.000000              3.000000        0.000000   
25%         1.000000     0.000000             30.000000        0.000000   
50%         6.000000     0.000000             35.000000        0.000000   
75%        12.000000     0.000000             38.000000        1.000000   
max        36.000000     1.000000             47.000000       10.000000   

       Seconds of Use  Frequency of use  Frequency of SMS  \
count     3150.000000       3150.000000       3150.000000   
mean      4472.459683         69.460635         73.174921   
std       4197.908687         57.413308        112.237560   
min          0.000000          0.000000          0.000000   
25%       1391.250000         27.000000          6.000000   
50%       2990.000000         54.000000         21.000000   
75%       6478.250000         95.000000         87.000000   
max      17090.000000        255.000000        522.000000   

       Distinct Called Numbers    Age Group  Tariff Plan       Status  \
count              3150.000000  3150.000000  3150.000000  3150.000000   
mean                 23.509841     2.826032     1.077778     1.248254   
std                  17.217337     0.892555     0.267864     0.432069   
min                   0.000000     1.000000     1.000000     1.000000   
25%                  10.000000     2.000000     1.000000     1.000000   
50%                  21.000000     3.000000     1.000000     1.000000   
75%                  34.000000     3.000000     1.000000     1.000000   
max                  97.000000     5.000000     2.000000     2.000000   

               Age  Customer Value        Churn  
count  3150.000000     3150.000000  3150.000000  
mean     30.998413      470.972916     0.157143  
std       8.831095      517.015433     0.363993  
min      15.000000        0.000000     0.000000  
25%      25.000000      113.801250     0.000000  
50%      30.000000      228.480000     0.000000  
75%      30.000000      788.388750     0.000000  
max      55.000000     2165.280000     1.000000  
</pre></div>
</div>
</div>
</div>
<p>Kode diatas menunjukan deskripsi dari dataframe, berikut penjelasannya :</p>
<ol class="arabic simple">
<li><p>Count : Jumlah entri non-null di setiap kolom. Semua kolom memiliki 3150 entri.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Mean : Nilai rata-rata dari setiap kolom.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure : 7.627937</p></li>
</ul>
<ul class="simple">
<li><p>Complains : 0.076508</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 32.541905</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount : 0.942857</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use : 4472.459683</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use : 69.460635</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS : 73.174921</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers : 23.509841</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  : 2.826032</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan : 1.077778</p></li>
</ul>
<ul class="simple">
<li><p>Status : 1.248254</p></li>
</ul>
<ul class="simple">
<li><p>Age : 8.831095</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value : 517.015433</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 0.363993</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Standard Deviation : Seberapa jauh data tersebar dari nilai rata-rata.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure : 7.263886</p></li>
</ul>
<ul class="simple">
<li><p>Complains : 0.265851</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 8.573482</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount : 1.521072</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use : 4197.908687</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use :  57.413308</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS :  112.237560</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers : 17.217337</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  : 0.892555</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan : 0.267864</p></li>
</ul>
<ul class="simple">
<li><p>Status :   0.432069</p></li>
</ul>
<ul class="simple">
<li><p>Age : 30.998413</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value : 470.972916</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 0.157143</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Minimum : Nilai minimum di setiap kolom.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Complains :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 3.000000</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use :   0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS :   0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Status :    1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age : 15.000000</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 0.000000</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>25th percentile (Q1) : nilai yang membagi data menjadi dua bagian, dimana 25% data dibawah ini.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Complains :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 30.000000</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use :  1391.250000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use : 27.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS : 6.000000</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers :   10.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  : 2.000000</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Status : 1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age : 25.000000</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value : 113.801250</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 0.000000</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p>50th percentile (median/Q2) : nilai yang membagi data menjadi dua bagian sama besar.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure :  6.000000</p></li>
</ul>
<ul class="simple">
<li><p>Complains :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 35.000000</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use :  2990.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use : 54.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS : 21.000000</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers :   21.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  : 3.000000</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Status : 1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age : 30.000000</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value : 228.480000</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 0.000000</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>75th percentile (Q3) : nilai yang membagi data menjadi dua bagian, dimana 75% data dibawah ini.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure :  12.000000</p></li>
</ul>
<ul class="simple">
<li><p>Complains :  0.000000</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 38.000000</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use :  6478.250000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use : 95.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS : 87.000000</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers :   34.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  : 3.000000</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Status : 1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age : 30.000000</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value : 788.388750</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 0.000000</p></li>
</ul>
<ol class="arabic simple" start="8">
<li><p>maximum : nilai maksimum dari setiap kolom.</p></li>
</ol>
<ul class="simple">
<li><p>Call Failure :  36.000000</p></li>
</ul>
<ul class="simple">
<li><p>Complains :  1.000000</p></li>
</ul>
<ul class="simple">
<li><p>Subscription Length : 47.000000</p></li>
</ul>
<ul class="simple">
<li><p>Charge Amount :  10.000000</p></li>
</ul>
<ul class="simple">
<li><p>Seconds of Use :  17090.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of use : 255.000000</p></li>
</ul>
<ul class="simple">
<li><p>Frequency of SMS : 522.000000</p></li>
</ul>
<ul class="simple">
<li><p>Distinct Called Numbers :   97.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age Group  : 5.000000</p></li>
</ul>
<ul class="simple">
<li><p>Tariff Plan :  2.000000</p></li>
</ul>
<ul class="simple">
<li><p>Status : 2.000000</p></li>
</ul>
<ul class="simple">
<li><p>Age : 55.000000</p></li>
</ul>
<ul class="simple">
<li><p>Customer Value : 2165.280000</p></li>
</ul>
<ul class="simple">
<li><p>Churn : 1.000000</p></li>
</ul>
</section>
</section>
<section id="identifikasi-kualitas-data">
<h2>Identifikasi Kualitas Data<a class="headerlink" href="#identifikasi-kualitas-data" title="Link to this heading">#</a></h2>
<p>Identifikasi kualitas data adalah langkah penting dalam proses analisis data untuk memastikan bahwa data yang digunakan adalah akurat, konsisten, dan lengkap. Berikut adalah beberapa aspek penting yang harus diperiksa dalam dataset Iranian Churn:</p>
<section id="deteksi-data-missing-values">
<h3>1. Deteksi Data Missing Values<a class="headerlink" href="#deteksi-data-missing-values" title="Link to this heading">#</a></h3>
<p>Melakukan pengecekan apakah terdapat missing values atau tidak dan memunculkan jumlah masing-masing di setiap fiturnya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Melakukan pengecekan apakah terdapat missing value dalam setiap kolom</span>
<span class="n">missing_val</span> <span class="o">=</span> <span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Menampilkan berapa jumlah adanya missing value untuk setiap kolomnya</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah nilai yang hilang untuk setiap kolom:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_val</span><span class="p">)</span>

<span class="c1"># Melakukan pengecekan apakah ada nilai null atau missing value</span>
<span class="k">if</span> <span class="n">missing_val</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tidak ada missing value.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Terdapat missing value dalam dataset.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah nilai yang hilang untuk setiap kolom:
Call  Failure              0
Complains                  0
Subscription  Length       0
Charge  Amount             0
Seconds of Use             0
Frequency of use           0
Frequency of SMS           0
Distinct Called Numbers    0
Age Group                  0
Tariff Plan                0
Status                     0
Age                        0
Customer Value             0
Churn                      0
dtype: int64
Tidak ada missing value.
</pre></div>
</div>
</div>
</div>
<p>Dapat disimpulkan bahwa pada dataset tidak terdapat missing values. Maka tidak perlu melakukan proses imputasi data missing values.</p>
</section>
<section id="deteksi-data-outlier">
<h3>2. Deteksi Data Outlier<a class="headerlink" href="#deteksi-data-outlier" title="Link to this heading">#</a></h3>
<p>Disini saya menggunakan metode LOF untuk mendeteksi outlier di setiap kolom fitur dataset.</p>
<p>Local Outlier Factor (LOF) :</p>
<p>Local Outlier Factor (LOF) adalah sebuah algoritma yang digunakan untuk mendeteksi outlier dalam data berdasarkan konsep kepadatan lokal.</p>
<p>Konsep Local Outlier Factor (LOF) :</p>
<p>LOF mengukur tingkat keanehan (outlierness) suatu titik data dengan membandingkan kerapatannya dengan kerapatan tetangganya. Beberapa konsep utama dalam LOF adalah:</p>
<p>K-distance: Jarak antara titik data dan titik terjauh dalam k tetangga terdekatnya.
Reachability Distance: Jarak antara dua titik data, dikoreksi dengan k-distance. Ini digunakan untuk mengukur seberapa mudah satu titik bisa “dicapai” dari titik lain.
Local Reachability Density (LRD): Kepadatan lokal di sekitar suatu titik data, dihitung sebagai kebalikan dari jarak rata-rata ketercapaian dari titik tersebut ke k tetangga terdekatnya.
Local Outlier Factor: Rasio LRD titik data terhadap LRD tetangganya. LOF &gt; 1 menunjukkan bahwa titik tersebut adalah outlier, sedangkan LOF ≈ 1 menunjukkan bahwa titik tersebut bukan outlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Fetch dataset directly from UCIML repository</span>
<span class="n">iranian_churn</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">563</span><span class="p">)</span>

<span class="c1"># Extract features and targets</span>
<span class="n">iranian_churn_features</span> <span class="o">=</span> <span class="n">iranian_churn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span>
<span class="n">iranian_churn_targets</span> <span class="o">=</span> <span class="n">iranian_churn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># Define feature names and target name</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">iranian_churn_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">target_name</span> <span class="o">=</span> <span class="s2">&quot;Churn&quot;</span>

<span class="c1"># Create DataFrame from features and target</span>
<span class="n">df_iranian_churn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">iranian_churn_features</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">iranian_churn_targets</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span> <span class="o">+</span> <span class="p">[</span><span class="n">target_name</span><span class="p">])</span>

<span class="c1"># Create LOF model</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.013</span><span class="p">)</span>

<span class="c1"># Predict outliers for each numeric feature</span>
<span class="n">outlier_indices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">:</span>
    <span class="c1"># Get feature values</span>
    <span class="n">feature_values</span> <span class="o">=</span> <span class="n">df_iranian_churn</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Predict outliers</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">feature_values</span><span class="p">)</span>
    <span class="c1"># Add outlier indices to the list</span>
    <span class="n">outlier_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Remove duplicate outlier indices</span>
<span class="n">outlier_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">outlier_indices</span><span class="p">))</span>

<span class="c1"># Display found outlier indices</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OUTLIER&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outlier_indices</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Outlier ditemukan pada baris =&gt; </span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, pada kolom fitur =&gt; </span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Collect row indices that contain outliers</span>
<span class="n">outlier_row_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">outlier_indices</span><span class="p">]</span>

<span class="c1"># Display data on rows containing outliers</span>
<span class="n">outlier_data</span> <span class="o">=</span> <span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">outlier_row_indices</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DATA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data pada baris yang mengandung outlier:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outlier_data</span><span class="p">)</span>

<span class="c1"># Assume you have ground truth labels for outliers</span>
<span class="c1"># For example, in this list, value 1 indicates an outlier, and 0 indicates not an outlier</span>
<span class="n">ground_truth_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outlier_row_indices</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_iranian_churn</span><span class="p">))]</span>

<span class="c1"># Generate outlier predictions based on outlier_row_indices</span>
<span class="n">predicted_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outlier_row_indices</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_iranian_churn</span><span class="p">))]</span>

<span class="c1"># Calculate precision</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">ground_truth_labels</span><span class="p">,</span> <span class="n">predicted_labels</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PRECISION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize outliers for each numeric feature</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_iranian_churn</span><span class="p">[</span><span class="n">column</span><span class="p">])),</span> <span class="n">df_iranian_churn</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
    <span class="n">outlier_indices_for_column</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outlier_indices</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">column</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outlier_indices_for_column</span><span class="p">,</span> <span class="n">df_iranian_churn</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">outlier_indices_for_column</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outlier&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Index&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Outlier Detection for </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OUTLIER
Outlier ditemukan pada baris =&gt; 1201, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 55, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 539, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1001, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1150, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1988, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2523, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 3049, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2358, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1297, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1216, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1203, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2972, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1301, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2403, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2362, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 678, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 189, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 550, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 561, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 599, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 358, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1823, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 73, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1882, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1918, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2741, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 183, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2723, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2171, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 697, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 68, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2031, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1231, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 268, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1799, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 3049, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2597, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 2584, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 678, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1869, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 361, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2358, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2950, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2872, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2962, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 110, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 3128, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2483, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2383, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1435, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2673, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 68, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2031, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 162, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 3139, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2354, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 693, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2823, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2269, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2957, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2583, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 471, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 631, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2983, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1716, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1091, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1572, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 883, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 3070, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1851, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2360, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 539, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 374, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 910, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1304, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2473, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2362, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 659, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2640, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1172, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2612, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2901, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 463, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 273, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 529, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2261, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1546, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1448, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2562, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2763, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 3123, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1878, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1572, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 3048, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2570, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 185, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1881, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2653, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2770, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1262, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 472, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 855, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2350, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2361, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 593, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 694, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1227, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1220, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2120, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2571, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2758, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 3020, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2091, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2583, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2463, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2576, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1181, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2081, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2748, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2363, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2970, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2886, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2791, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1620, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2367, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2997, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1474, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2583, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 3040, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 215, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 257, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1868, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1332, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2519, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1922, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1081, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2236, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 751, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2353, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 951, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2081, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 70, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2495, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 668, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 270, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2759, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 155, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1502, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 172, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2828, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2669, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 3120, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2749, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1736, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2257, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1504, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 101, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1533, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 3033, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2259, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2562, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 1428, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 598, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 3089, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1519, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 233, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 492, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 951, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2359, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 72, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2657, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2522, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1496, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 796, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1402, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1958, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2617, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 370, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1373, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 1667, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 516, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 741, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1613, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2983, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2553, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2304, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 781, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 3012, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2515, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1533, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2187, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1101, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 369, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1394, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1845, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 212, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1449, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1273, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 1973, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 1305, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2673, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2139, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2194, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2383, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2873, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2974, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2195, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1181, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2622, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2633, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1933, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2395, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 3073, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2822, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1405, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 283, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 3078, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 1290, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2351, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2583, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 801, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1690, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1673, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 922, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 805, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2355, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2970, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 898, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2270, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1132, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2041, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 916, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 483, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1512, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 1779, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2581, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1081, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1558, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1132, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 152, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 1001, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1518, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 378, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1524, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 1173, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 1267, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 2283, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 578, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 1292, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2470, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1792, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 269, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2670, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 1173, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 2612, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 347, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 1912, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2881, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2123, pada kolom fitur =&gt; Call  Failure
Outlier ditemukan pada baris =&gt; 2492, pada kolom fitur =&gt; Frequency of SMS
Outlier ditemukan pada baris =&gt; 2128, pada kolom fitur =&gt; Customer Value
Outlier ditemukan pada baris =&gt; 2562, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 2683, pada kolom fitur =&gt; Distinct Called Numbers
Outlier ditemukan pada baris =&gt; 168, pada kolom fitur =&gt; Seconds of Use
Outlier ditemukan pada baris =&gt; 523, pada kolom fitur =&gt; Charge  Amount
Outlier ditemukan pada baris =&gt; 2356, pada kolom fitur =&gt; Subscription  Length
Outlier ditemukan pada baris =&gt; 2603, pada kolom fitur =&gt; Frequency of use
Outlier ditemukan pada baris =&gt; 899, pada kolom fitur =&gt; Subscription  Length
DATA
Data pada baris yang mengandung outlier:
      Call  Failure  Complains  Subscription  Length  Charge  Amount  \
1201            0.0        0.0                  41.0             0.0   
55             14.0        0.0                  40.0             2.0   
539             0.0        0.0                  26.0             0.0   
1001            0.0        0.0                  39.0             0.0   
1150            0.0        0.0                  34.0             0.0   
...             ...        ...                   ...             ...   
168             1.0        0.0                  41.0             0.0   
523            17.0        0.0                  36.0             6.0   
2356           14.0        0.0                  46.0             2.0   
2603           11.0        0.0                  40.0             0.0   
899             9.0        0.0                  10.0             2.0   

      Seconds of Use  Frequency of use  Frequency of SMS  \
1201            93.0               1.0              10.0   
55            3835.0              85.0              37.0   
539            968.0              29.0               9.0   
1001           318.0               5.0               7.0   
1150          4005.0              62.0               0.0   
...              ...               ...               ...   
168             80.0               2.0              10.0   
523           9835.0              83.0               0.0   
2356          2925.0              55.0             307.0   
2603          3903.0              62.0               7.0   
899           2197.0              30.0               8.0   

      Distinct Called Numbers  Age Group  Tariff Plan  Status   Age  \
1201                      6.0        2.0          1.0     2.0  25.0   
55                       30.0        3.0          2.0     1.0  30.0   
539                      53.0        4.0          1.0     1.0  45.0   
1001                      4.0        2.0          1.0     2.0  25.0   
1150                     13.0        2.0          1.0     1.0  25.0   
...                       ...        ...          ...     ...   ...   
168                       4.0        2.0          1.0     2.0  25.0   
523                      27.0        4.0          1.0     1.0  45.0   
2356                     26.0        4.0          1.0     1.0  45.0   
2603                     22.0        1.0          1.0     1.0  15.0   
899                       7.0        3.0          1.0     1.0  30.0   

      Customer Value  Churn  
1201          49.230    0.0  
55           304.800    0.0  
539           47.425    0.0  
1001          46.035    0.0  
1150         183.015    0.0  
...              ...    ...  
168           48.690    1.0  
523          247.950    0.0  
2356         842.000    0.0  
2603         256.575    0.0  
899          121.080    1.0  

[271 rows x 14 columns]
PRECISION
Precision: 1.0
</pre></div>
</div>
<img alt="_images/1977cb29c5dc838386d4d1ac60ac6c86af000a1aaa1c05a81f727e863d63b2a2.png" src="_images/1977cb29c5dc838386d4d1ac60ac6c86af000a1aaa1c05a81f727e863d63b2a2.png" />
<img alt="_images/a526c2961a83867c49893f453dc723abf5dab2520c2e3d09e1c7ed69f5d87412.png" src="_images/a526c2961a83867c49893f453dc723abf5dab2520c2e3d09e1c7ed69f5d87412.png" />
<img alt="_images/69ff9989f16fba4bba6c53a46ce38629ed48058a236f0a111e1e3d218b94d79f.png" src="_images/69ff9989f16fba4bba6c53a46ce38629ed48058a236f0a111e1e3d218b94d79f.png" />
<img alt="_images/1a8d54545a693f2875041d709854aae42641a4b4c722587f4c583e256536a69a.png" src="_images/1a8d54545a693f2875041d709854aae42641a4b4c722587f4c583e256536a69a.png" />
<img alt="_images/e182ab68854a7d552acf7aafccd71f979e523b15490fcb8c085bb233c806a3a3.png" src="_images/e182ab68854a7d552acf7aafccd71f979e523b15490fcb8c085bb233c806a3a3.png" />
<img alt="_images/1e23b3fe274f4177717ff29d16b512de8f0a64fced3ac67bb1d07f2f47c55d94.png" src="_images/1e23b3fe274f4177717ff29d16b512de8f0a64fced3ac67bb1d07f2f47c55d94.png" />
<img alt="_images/106ef97378e4a09ae96e9a497948dc31c819b7e3b2da2d3541635a5777e7fc71.png" src="_images/106ef97378e4a09ae96e9a497948dc31c819b7e3b2da2d3541635a5777e7fc71.png" />
<img alt="_images/dedf189c50aa87c80fa8be04d93d5156224bd87152fc99f4cd2e40712c744c2f.png" src="_images/dedf189c50aa87c80fa8be04d93d5156224bd87152fc99f4cd2e40712c744c2f.png" />
<img alt="_images/0659823ec7d78d04c1e4e916fb44f512dd275f5105a208f73aad3599734f45f7.png" src="_images/0659823ec7d78d04c1e4e916fb44f512dd275f5105a208f73aad3599734f45f7.png" />
<img alt="_images/dfdb6fba56ea7ff7dfaab2924bce33c72a3ad5d7fefc8849b980dbde8d568e3d.png" src="_images/dfdb6fba56ea7ff7dfaab2924bce33c72a3ad5d7fefc8849b980dbde8d568e3d.png" />
<img alt="_images/f586afc79ee34fe193c081c71b4bf402607ccd8047334df52facd779b47ca510.png" src="_images/f586afc79ee34fe193c081c71b4bf402607ccd8047334df52facd779b47ca510.png" />
<img alt="_images/e3207bfc82c329be75e82e8589547b695fe4520e9f5cabf913a176756ff31bef.png" src="_images/e3207bfc82c329be75e82e8589547b695fe4520e9f5cabf913a176756ff31bef.png" />
<img alt="_images/526a5e0be773b0fd76b4cfa7df305e5f418fec707bd8e5b3f84107f8f3f6b562.png" src="_images/526a5e0be773b0fd76b4cfa7df305e5f418fec707bd8e5b3f84107f8f3f6b562.png" />
</div>
</div>
<p>Penanganan outlier dalam konteks ini tidak dilakukan karena data yang terindikasi sebagai outlier masih berada dalam rentang yang wajar dan tidak melebihi interval yang ditentukan. Selain itu, akurasi pendeteksian outlier menunjukkan hasil yang sangat tinggi dengan nilai precision sebesar 1 atau 100%, yang bisa dikatakan sempurna.</p>
</section>
<section id="deteksi-duplikasi-dataset">
<h3>3. Deteksi Duplikasi Dataset<a class="headerlink" href="#deteksi-duplikasi-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">duplicates</span> <span class="o">=</span> <span class="n">df_iranian_churn</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data yang Duplikat:&quot;</span><span class="p">,</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data yang Duplikat: 300
</pre></div>
</div>
</div>
</div>
<p>Terdapat duplikasi data pada dataset “Iranian Churn” yaitu 300 data duplikasi.
Karna terdapat duplikasi data, perlu adanya penghapusan duplikasi data.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prepocessing-data">
<h1>3. Prepocessing Data<a class="headerlink" href="#prepocessing-data" title="Link to this heading">#</a></h1>
<p>Preprocessing data adalah langkah penting sebelum melakukan analisis lebih lanjut atau penerapan model machine learning. Dalam konteks dataset churn pelanggan dari perusahaan telekomunikasi Iran, preprocessing data mencakup beberapa langkah penting yang dirancang untuk memastikan data tersebut berkualitas tinggi dan siap untuk analisis lebih lanjut.
Dalam kasus ini, tidak ditemukan missing value dan outlier sehingga tidak diperlukan pengisian atau penghapusan data. Tetapi terdapat duplikasi data yang perlu adanya penghapusan data yang duplikasi.</p>
<p>Penghapusan duplikasi data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the cleaned CSV file into a DataFrame</span>
<span class="n">df_iranian_churn_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn.csv&#39;</span><span class="p">)</span>

<span class="c1"># Remove duplicates</span>
<span class="n">df_iranian_churn_clean</span> <span class="o">=</span> <span class="n">df_iranian_churn_clean</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Display the cleaned data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data yang sudah bersih (clean):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_iranian_churn_clean</span><span class="p">)</span>

<span class="c1"># Check for duplicates again</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">df_iranian_churn_clean</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data yang Duplikat:&quot;</span><span class="p">,</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># Save the cleaned data to a new CSV file</span>
<span class="n">df_iranian_churn_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-11-7f0517a96720&gt;</span> in <span class="ni">&lt;cell line: 4&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Load the cleaned CSV file into a DataFrame</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">df_iranian_churn_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># Remove duplicates</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">910</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">911</span> 
<span class="ne">--&gt; </span><span class="mi">912</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">913</span> 
<span class="g g-Whitespace">    </span><span class="mi">914</span> 

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">575</span> 
<span class="g g-Whitespace">    </span><span class="mi">576</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">577</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span> 
<span class="g g-Whitespace">    </span><span class="mi">579</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1405</span> 
<span class="g g-Whitespace">   </span><span class="mi">1406</span>         <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1407</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1408</span> 
<span class="g g-Whitespace">   </span><span class="mi">1409</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1659</span>                 <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1660</span>                     <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1661</span>             <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1662</span>                 <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1663</span>                 <span class="n">mode</span><span class="p">,</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>         <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>             <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">859</span>             <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>                 <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>                 <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;iranian_churn.csv&#39;
</pre></div>
</div>
</div>
</div>
<p>Jumlah data setelah penghapusan duplikasi data yaitu 2850.</p>
<p>Sudah bisa dipastikan bahwa kualitas atas identifikasi data sudah bisa dikatakan baik, jadi bisa melanjutkan ke tahap modelling.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelling">
<h1>4. Modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h1>
<p>Untuk tahap modelling, kita akan membangun model klasifikasi untuk memprediksi churn (churn atau non-churn) menggunakan data yang sudah bersih dari duplikasi.  Kita juga akan membagi data menjadi set pelatihan dan set pengujian</p>
<section id="implementasi-metode-klasifikasi-naive-bayes">
<h2>Implementasi Metode Klasifikasi Naive Bayes<a class="headerlink" href="#implementasi-metode-klasifikasi-naive-bayes" title="Link to this heading">#</a></h2>
<p>Naive Bayes adalah salah satu algoritma klasifikasi yang paling sederhana dan cepat, yang sering digunakan dalam klasifikasi teks seperti email spam detection, sentiment analysis, dll. Algoritma ini didasarkan pada Teorema Bayes dengan asumsi kemandirian antara prediktor. Meski asumsi ini jarang berlaku dalam praktik, Naive Bayes sering kali bekerja dengan baik dalam berbagai aplikasi dunia nyata.</p>
<section id="membagi-data-train-dan-data-test">
<h3>Membagi Data Train dan Data Test<a class="headerlink" href="#membagi-data-train-dan-data-test" title="Link to this heading">#</a></h3>
<p>Disini saya membagi datanya 80% data train dan 20% data test. Inii dilakukan supaya mendapatkan hasil yang lebih efektif.</p>
<p>Data Train</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Load cleaned dataset from CSV</span>
<span class="n">df_iranian_churn_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">)</span>

<span class="c1"># Define feature names and target name</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">df_iranian_churn_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Exclude the last column &#39;Churn&#39;</span>
<span class="n">target_name</span> <span class="o">=</span> <span class="s1">&#39;Churn&#39;</span>

<span class="c1"># Define features and target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_iranian_churn_clean</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_iranian_churn_clean</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span>

<span class="c1"># Membagi dataset menjadi data latih (train set) saja</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Simpan data latih ke dalam file CSV</span>
<span class="n">trained</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">trained</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_train.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Print informasi mengenai dataset latih</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data training: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">trained</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trained</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># Menampilkan 5 baris pertama dari data training</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data training: 2280
      Call  Failure  Complains  Subscription  Length  Charge  Amount  \
942               2          0                    15               2   
598               3          0                    10               2   
2676              6          0                    32               0   
2212              7          0                    33               1   
789               0          0                    20               0   

      Seconds of Use  Frequency of use  Frequency of SMS  \
942             2142                34                 6   
598             1603                25                32   
2676            1970                44                37   
2212           11510               150                 7   
789             3225                55                 0   

      Distinct Called Numbers  Age Group  Tariff Plan  Status  Age  \
942                        19          3            1       1   30   
598                        11          3            1       1   30   
2676                       21          3            1       2   30   
2212                       43          4            1       1   45   
789                        22          3            1       1   30   

      Customer Value  Churn  
942           111.04      0  
598           193.12      1  
2676          228.56      0  
2212          309.00      0  
789           131.20      0  
</pre></div>
</div>
</div>
</div>
<p>Jumlah data train yaitu 2280</p>
<p>Data Test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_test.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah data testing : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data testing : 570
      Call  Failure  Complains  Subscription  Length  Charge  Amount  \
1577             20          0                    28               1   
324               8          1                    30               0   
2089             14          0                    22               5   
1817              2          0                    35               0   
2177             12          0                    44               2   
...             ...        ...                   ...             ...   
163               5          0                    42               2   
2373              9          0                    38               0   
252              15          0                    43               1   
1783             13          0                    20               1   
2845             17          0                    17               1   

      Seconds of Use  Frequency of use  Frequency of SMS  \
1577           15655               226                 0   
324             5558                88                11   
2089            3238                53                48   
1817            2073                30                 1   
2177            4283                98                24   
...              ...               ...               ...   
163             3175                29               493   
2373            1533                23                37   
252             2713                70               374   
1783            6087               141                86   
2845            9237               177                80   

      Distinct Called Numbers  Age Group  Tariff Plan  Status  Age  \
1577                       74          2            1       1   25   
324                        18          2            1       1   25   
2089                       25          3            2       1   30   
1817                        4          3            1       1   30   
2177                       36          3            1       1   30   
...                       ...        ...          ...     ...  ...   
163                        12          3            1       1   30   
2373                       21          4            1       2   45   
252                        30          3            1       1   30   
1783                       41          2            2       1   25   
2845                       42          5            1       1   55   

      Customer Value  Churn  
1577         714.645      0  
324          303.570      1  
2089         323.640      0  
1817          88.120      0  
2177         271.240      0  
...              ...    ...  
163         2100.160      0  
2373         131.400      1  
252         1607.320      0  
1783         667.260      0  
2845         261.210      0  

[570 rows x 14 columns]
</pre></div>
</div>
</div>
</div>
<p>Jumlah data test yaitu 570.</p>
</section>
<section id="melakukan-prediksi-dengan-sklearn-naive-bayes">
<h3>Melakukan Prediksi dengan Sklearn Naive Bayes<a class="headerlink" href="#melakukan-prediksi-dengan-sklearn-naive-bayes" title="Link to this heading">#</a></h3>
<p>Hasil Akurasi dan Predict Data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Impor library yang diperlukan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Memuat dataset dari file CSV</span>
<span class="n">iranian_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan fitur (X) dan target (y) dari dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iranian_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">])</span>  <span class="c1"># Anggap &#39;Churn&#39; adalah kolom target</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iranian_data</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span>

<span class="c1"># Memisahkan dataset menjadi data latih dan data uji</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Menggabungkan fitur dan label data latih ke dalam DataFrame untuk disimpan</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Menggabungkan fitur dan label data uji ke dalam DataFrame untuk disimpan</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Menyimpan data latih dan data uji ke dalam file CSV</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;iranian_churn_Train.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;iranian_churn_Test.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Konfirmasi penyimpanan</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data train dan test berhasil disimpan.&quot;</span><span class="p">)</span>

<span class="c1"># Membangun model Naive Bayes Gaussian</span>
<span class="n">gnb_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

<span class="c1"># Melatih model menggunakan data latih</span>
<span class="n">gnb_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Memprediksi label untuk data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gnb_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Evaluasi performa model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Akurasi: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

<span class="c1"># Memprediksi kelas untuk data baru</span>
<span class="n">new_data_point</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3225</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">945.44</span><span class="p">]]</span>
<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">gnb_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data_point</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hasil Class Churn yang diprediksi untuk data baru:&#39;</span><span class="p">,</span> <span class="n">predicted_class</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data train dan test berhasil disimpan.
Akurasi: 76.14%
Hasil Class Churn yang diprediksi untuk data baru: [0]
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but GaussianNB was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<p>Hasil prediksi menunjukkan bahwa model dapat diandalkan untuk memprediksi churn dengan akurasi tinggi (76,14%), terutama setelah penghapusan duplikasi data. Oleh karena itu, penggunaan dataset yang bersih dan bebas dari duplikasi sangat disarankan untuk mencapai performa model yang optimal.</p>
<p>Dengan hasil analisis menggunakan metode klasifikasi ini, sistem prediksi churn dapat membantu meningkatkan efisiensi dalam pengelolaan pelanggan di industri maupun perusahaan penyedia layanan. Model ini memberikan prediksi yang cukup akurat, sehingga dapat diandalkan dalam pengambilan keputusan terkait retensi dan strategi layanan pelanggan.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ensemble-learning">
<h1>Ensemble Learning<a class="headerlink" href="#ensemble-learning" title="Link to this heading">#</a></h1>
<p>Ensemble learning adalah teknik yang kuat untuk meningkatkan performa model machine learning dengan menggabungkan beberapa model. Dengan memanfaatkan berbagai metode seperti bagging, boosting, dan stacking, ensemble learning dapat menghasilkan model yang lebih akurat, lebih robust, dan lebih stabil dibandingkan dengan model tunggal. Namun, ensemble learning juga menghadapi tantangan seperti kompleksitas, kebutuhan sumber daya yang lebih tinggi, dan tuning yang lebih sulit.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stacking-classifier-meta-classifier">
<h1>Stacking Classifier (Meta Classifier)<a class="headerlink" href="#stacking-classifier-meta-classifier" title="Link to this heading">#</a></h1>
<p>Stacking (Stacked Generalization) adalah teknik ensemble learning yang menggabungkan beberapa model (dikenal sebagai base learners atau level-0 models) untuk meningkatkan performa prediksi dengan menggunakan model lain (dikenal sebagai meta-learner atau level-1 model) yang belajar untuk menggabungkan prediksi dari base learners. Berikut adalah penjelasan rinci tentang stacking classifier:</p>
<p>Konsep Dasar</p>
<p>Base Learners:</p>
<p>Ini adalah model-model individu yang dilatih pada data pelatihan. Base learners dapat terdiri dari berbagai jenis model, seperti decision trees, logistic regression, support vector machines, dll.
Base learners bekerja secara paralel dan menghasilkan prediksi masing-masing untuk data pelatihan dan data uji.</p>
<p>Meta-Learner:</p>
<p>Meta-learner adalah model yang dilatih untuk menggabungkan prediksi dari base learners. Ini dapat berupa model sederhana seperti linear regression atau model yang lebih kompleks seperti neural networks.
Meta-learner belajar dari prediksi base learners dan target sebenarnya untuk meminimalkan kesalahan prediksi.</p>
<p>Keuntungan dan Tantangan Stacking Classifier</p>
<p>Keuntungan:</p>
<ul class="simple">
<li><p>Menggabungkan Kekuatan Model Berbeda: Stacking memungkinkan penggunaan berbagai model untuk menangkap berbagai pola dalam data.</p></li>
</ul>
<ul class="simple">
<li><p>Meningkatkan Akurasi: Dengan menggabungkan prediksi dari beberapa model, stacking dapat meningkatkan akurasi prediksi.</p></li>
</ul>
<ul class="simple">
<li><p>Fleksibilitas: Base learners dan meta-learner dapat berupa model apa saja, memberikan fleksibilitas dalam pemilihan model.</p></li>
</ul>
<p>Tantangan:</p>
<ul class="simple">
<li><p>Kompleksitas: Stacking lebih kompleks daripada metode ensemble lainnya seperti bagging dan boosting.</p></li>
</ul>
<ul class="simple">
<li><p>Waktu dan Sumber Daya: Membutuhkan lebih banyak waktu dan sumber daya untuk melatih beberapa model.</p></li>
</ul>
<ul class="simple">
<li><p>Overfitting: Meta-learner bisa overfit pada meta-features jika tidak diatur dengan benar.</p></li>
</ul>
<section id="a-meta-predict-classifier-model-naive-bayes-manual">
<h2>A. Meta Predict Classifier Model Naive Bayes Manual<a class="headerlink" href="#a-meta-predict-classifier-model-naive-bayes-manual" title="Link to this heading">#</a></h2>
<section id="model-p1">
<h3>Model P1<a class="headerlink" href="#model-p1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install paket yang diperlukan</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>ucimlrepo

<span class="c1"># Import library yang diperlukan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># Memuat dataset dari file CSV</span>
<span class="n">iranian_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan fitur dan target dari dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iranian_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">])</span>  <span class="c1"># Mengasumsikan &#39;Churn&#39; sebagai kolom target</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iranian_data</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span>

<span class="c1"># Encode labels jika diperlukan</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Bagi dataset menjadi data latih dan data uji</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Inisialisasi classifier KNN dengan k=3</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Latih model pada data latih</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Evaluasi model pada data latih</span>
<span class="n">XTrain1</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">accuracy_train</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">XTrain1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi pada data train: </span><span class="si">{</span><span class="n">accuracy_train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Evaluasi model pada data uji</span>
<span class="n">XTest1</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_test</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">XTest1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi pada data test: </span><span class="si">{</span><span class="n">accuracy_test</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Prediksi untuk instance baru</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3225</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">945.44</span><span class="p">]]</span>
<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">predicted_class</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi Class Churn untuk data inputan baru: </span><span class="si">{</span><span class="n">predicted_class</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting ucimlrepo
  Downloading ucimlrepo-0.0.7-py3-none-any.whl (8.0 kB)
Requirement already satisfied: certifi&gt;=2020.12.5 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from ucimlrepo) (2022.9.24)
Requirement already satisfied: pandas&gt;=1.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from ucimlrepo) (2.1.4)
Requirement already satisfied: numpy&lt;2,&gt;=1.22.4 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (1.23.4)
Requirement already satisfied: pytz&gt;=2020.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2022.5)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.8.2)
Requirement already satisfied: tzdata&gt;=2022.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2022.5)
Requirement already satisfied: six&gt;=1.5 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;ucimlrepo) (1.16.0)
Installing collected packages: ucimlrepo
Successfully installed ucimlrepo-0.0.7

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.0.1</span> -&gt; <span class=" -Color -Color-Green">24.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
Akurasi pada data train: 0.93
Akurasi pada data test: 0.86
Prediksi Class Churn untuk data inputan baru: [0]
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-p2">
<h3>Model P2<a class="headerlink" href="#model-p2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang diperlukan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># Memuat dataset dari file CSV</span>
<span class="n">iranian_churn_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan fitur dan target dari dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iranian_churn_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">])</span>  <span class="c1"># Mengasumsikan &#39;Churn&#39; sebagai kolom target</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iranian_churn_data</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span>

<span class="c1"># Encode labels jika diperlukan</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Bagi dataset menjadi data latih dan data uji</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Inisialisasi classifier KNN dengan k=5</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Latih model pada data latih</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Evaluasi model pada data latih</span>
<span class="n">XTrain2</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">accuracy_train</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">XTrain2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi pada data train: </span><span class="si">{</span><span class="n">accuracy_train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Evaluasi model pada data uji</span>
<span class="n">XTest2</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_test</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">XTest2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi pada data test: </span><span class="si">{</span><span class="n">accuracy_test</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Prediksi untuk instance baru</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3225</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">945.44</span><span class="p">]]</span>
<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
<span class="n">predicted_class</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">predicted_class</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi Class Varietas untuk data inputan baru: </span><span class="si">{</span><span class="n">predicted_class</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Akurasi pada data train: 0.89
Akurasi pada data test: 0.85
Prediksi Class Varietas untuk data inputan baru: [0]
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but KNeighborsClassifier was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<p>Menggabungkan Hasil Prediksi 2 Model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Buat DataFrame gabungan untuk data pengujian</span>
<span class="n">combined_train_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">XTrain1</span><span class="p">),</span>
    <span class="s1">&#39;P2&#39;</span><span class="p">:</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">XTrain2</span><span class="p">),</span>
    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="p">})</span>

<span class="n">combined_train_df1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;combine_train.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Buat DataFrame gabungan untuk data pengujian</span>
<span class="n">combined_test_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">XTest1</span><span class="p">),</span>
    <span class="s1">&#39;P2&#39;</span><span class="p">:</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">XTest2</span><span class="p">),</span>
    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="p">})</span>

<span class="n">combined_test_df1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;combine_test.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hasil Train</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;combine_train.csv&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P1</th>
      <th>P2</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2275</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2276</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2278</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2279</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2280 rows × 3 columns</p>
</div></div></div>
</div>
<p>Hasil Test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;combine_test.csv&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P1</th>
      <th>P2</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>565</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>566</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>567</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>568</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>569</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>570 rows × 3 columns</p>
</div></div></div>
</div>
<p>Stacking dengan scikit_learn</p>
<p>Setelah memahami proses stacking classifier secara manual, langkah selanjutnya adalah menggunakan library untuk melatih model dasar dengan lebih efisien. Saya akan melatih 20 model KNN dengan nilai K yang berbeda, lalu menggabungkan prediksinya sebagai input untuk model Gaussian Naive Bayes. Pendekatan ini diharapkan dapat mengoptimalkan kinerja model secara keseluruhan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Load dataset from CSV</span>
<span class="n">iranian_churn_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">)</span>

<span class="c1"># Separate features and target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iranian_churn_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Assuming &#39;Churn&#39; is the target column</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iranian_churn_data</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Split data into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create list of estimators for StackingClassifier</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;knn&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="mi">3</span><span class="p">),</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

<span class="c1"># Initialize StackingClassifier with GaussianNB as final estimator</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span>
    <span class="n">estimators</span><span class="o">=</span><span class="n">estimators</span><span class="p">,</span> <span class="n">final_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># Train StackingClassifier</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Evaluate accuracy for each KNN model and store the results</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>
    <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy of </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>

<span class="c1"># Display accuracy of each KNN model</span>
<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">accuracy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">],</span> <span class="n">accuracies</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Evaluate predictions for new data point by each KNN model</span>
<span class="c1"># Example new data point with 13 features</span>
<span class="n">X_new</span> <span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3225</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">945.44</span><span class="p">]]</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction of </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">pred</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Counting predictions for each class</span>
<span class="n">unique_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">pred</span> <span class="o">==</span> <span class="bp">cls</span><span class="p">)</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">unique_classes</span><span class="p">}</span>

<span class="c1"># Display number of predictions for each class</span>
<span class="k">for</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Churn </span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> predictions&quot;</span><span class="p">)</span>

<span class="c1"># Predict for new data using StackingClassifier</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Prediction for X_new: </span><span class="si">{</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Evaluate overall performance of the stacking classifier</span>
<span class="n">avg_acc</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Overall Stacking Classifier Performance:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">avg_acc</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Obtain predictions from the model</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy of knn1: 0.8579
Accuracy of knn2: 0.8544
Accuracy of knn3: 0.8544
Accuracy of knn4: 0.8614
Accuracy of knn5: 0.8561
Accuracy of knn6: 0.8632
Accuracy of knn7: 0.8667
Accuracy of knn8: 0.8632
Accuracy of knn9: 0.8596
Accuracy of knn10: 0.8596
Accuracy of knn11: 0.8596
Accuracy of knn12: 0.8579
Accuracy of knn13: 0.8579
Accuracy of knn14: 0.8579
Accuracy of knn15: 0.8596
Accuracy of knn16: 0.8544
Accuracy of knn17: 0.8509
Accuracy of knn18: 0.8509
Accuracy of knn19: 0.8509
Accuracy of knn20: 0.8509
knn1: 0.8579
knn2: 0.8544
knn3: 0.8544
knn4: 0.8614
knn5: 0.8561
knn6: 0.8632
knn7: 0.8667
knn8: 0.8632
knn9: 0.8596
knn10: 0.8596
knn11: 0.8596
knn12: 0.8579
knn13: 0.8579
knn14: 0.8579
knn15: 0.8596
knn16: 0.8544
knn17: 0.8509
knn18: 0.8509
knn19: 0.8509
knn20: 0.8509
Prediction of knn1: 0
Prediction of knn2: 0
Prediction of knn3: 0
Prediction of knn4: 0
Prediction of knn5: 0
Prediction of knn6: 0
Prediction of knn7: 0
Prediction of knn8: 0
Prediction of knn9: 0
Prediction of knn10: 0
Prediction of knn11: 0
Prediction of knn12: 0
Prediction of knn13: 0
Prediction of knn14: 0
Prediction of knn15: 0
Prediction of knn16: 0
Prediction of knn17: 0
Prediction of knn18: 0
Prediction of knn19: 0
Prediction of knn20: 0
Churn 0: 20 predictions
Churn 1: 0 predictions

Prediction for X_new: 0

Overall Stacking Classifier Performance:
Accuracy: 0.7351
              precision    recall  f1-score   support

           0       0.96      0.72      0.82       486
           1       0.34      0.85      0.48        84

    accuracy                           0.74       570
   macro avg       0.65      0.78      0.65       570
weighted avg       0.87      0.74      0.77       570
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bagging">
<h1>Bagging<a class="headerlink" href="#bagging" title="Link to this heading">#</a></h1>
<p>Bagging, atau Bootstrap Aggregating, adalah teknik ensemble learning yang meningkatkan akurasi dan stabilitas model prediktif.</p>
<p>Proses:</p>
<p>Bootstrap Sampling: Beberapa subset data (dengan penggantian) diambil dari dataset asli. Tiap subset memiliki jumlah data yang sama dengan dataset asli.
Model Training: Model yang sama dilatih pada setiap subset bootstrap.
Aggregation: Prediksi dari semua model digabungkan. Untuk regresi, hasil akhir biasanya adalah rata-rata dari prediksi. Untuk klasifikasi, hasil akhir biasanya berdasarkan voting mayoritas.</p>
<p>Manfaat:</p>
<p>Mengurangi Variansi: Dengan menggabungkan prediksi dari beberapa model, bagging mengurangi variabilitas dan meningkatkan kestabilan model.
Meningkatkan Akurasi: Bagging sering meningkatkan akurasi dibandingkan dengan model tunggal.
Mengatasi Overfitting: Karena setiap model dilatih pada subset data yang berbeda, bagging membantu mengurangi risiko overfitting.</p>
<p>Kesimpulan
Bagging adalah metode yang efektif untuk meningkatkan performa model dengan mengurangi variansi dan overfitting melalui kombinasi prediksi dari beberapa model yang dilatih pada subset data yang berbeda.</p>
<p>Pada percobaan kali ini bagging sayamenggunakan 20 gaussian naive bayes yang menerima subset berbeda satu sama lain. Berikut Ini Implementasinya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Memuat dataset dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iranian_churn_clean.csv&#39;</span><span class="p">)</span>

<span class="c1"># Menghapus kolom &#39;Unnamed: 0&#39; jika ada</span>
<span class="k">if</span> <span class="s1">&#39;Unnamed: 0&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Memisahkan atribut dan label</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">])</span>  <span class="c1"># Atribut</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Churn&#39;</span><span class="p">]</span>  <span class="c1"># Label</span>

<span class="c1"># Pembagian dataset menjadi data latih dan data uji dengan rasio 80:20</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Parameter untuk teknik Bagging</span>
<span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_estimators</span><span class="p">)</span>

<span class="c1"># Inisialisasi list untuk menyimpan model dan akurasi</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pred</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Data baru yang akan diprediksi</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3225</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">945.44</span><span class="p">]],</span>
                     <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data baru yang akan diprediksi:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Membuat model Gaussian Naive Bayes untuk setiap subset</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">):</span>
    <span class="c1"># Membuat sampel bootstrap</span>
    <span class="n">bootstrap_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">X_train_bootstrap</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">bootstrap_indices</span><span class="p">]</span>
    <span class="n">y_train_bootstrap</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">bootstrap_indices</span><span class="p">]</span>
    
    <span class="c1"># Melatih model</span>
    <span class="n">gnb_model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
    <span class="n">gnb_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_bootstrap</span><span class="p">,</span> <span class="n">y_train_bootstrap</span><span class="p">)</span>
    <span class="n">estimators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gnb_model</span><span class="p">)</span>
    
    <span class="c1"># Evaluasi model    </span>
    <span class="n">prediksi</span> <span class="o">=</span> <span class="n">gnb_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
    <span class="n">pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediksi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Menyimpan prediksi dalam list pred</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">gnb_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">akurasi</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">akurasi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi Estimator </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">akurasi</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi Estimator </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">prediksi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Majority vote untuk prediksi data baru</span>
<span class="n">prediksi_majority_vote</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi mayoritas untuk data baru: </span><span class="si">{</span><span class="n">prediksi_majority_vote</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Menghitung jumlah prediksi untuk setiap kelas</span>
<span class="n">class_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">kelas</span><span class="p">,</span> <span class="n">jumlah</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_counts</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah prediksi untuk kelas </span><span class="si">{</span><span class="n">kelas</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">jumlah</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Menghitung rata-rata akurasi dari semua estimators</span>
<span class="n">akurasi_rata_rata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi rata-rata dari semua estimators: </span><span class="si">{</span><span class="n">akurasi_rata_rata</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot akurasi untuk masing-masing estimator</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Estimator&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Akurasi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Akurasi dari Setiap Estimator Gaussian Naive Bayes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot jumlah prediksi untuk setiap kelas pada data baru</span>
<span class="n">label_kelas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">nilai_kelas</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">label_kelas</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">label_kelas</span><span class="p">,</span> <span class="n">nilai_kelas</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="s1">&#39;skyblue&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Kelas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Prediksi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Jumlah Prediksi untuk Setiap Kelas oleh Estimators untuk Data Baru&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data baru yang akan diprediksi:
   Call  Failure  Complains  Subscription  Length  Charge  Amount  \
0             10          0                    35               0   

   Seconds of Use  Frequency of use  Frequency of SMS  \
0            3225                71                 5   

   Distinct Called Numbers  Age Group  Tariff Plan  Status  Age  \
0                       17          3            1       1   30   

   Customer Value  
0          945.44  

Akurasi Estimator 1 : 0.7614
Prediksi Estimator 1 : 0

Akurasi Estimator 2 : 0.7632
Prediksi Estimator 2 : 0

Akurasi Estimator 3 : 0.7246
Prediksi Estimator 3 : 0

Akurasi Estimator 4 : 0.7175
Prediksi Estimator 4 : 0

Akurasi Estimator 5 : 0.7491
Prediksi Estimator 5 : 0

Akurasi Estimator 6 : 0.7158
Prediksi Estimator 6 : 0

Akurasi Estimator 7 : 0.6842
Prediksi Estimator 7 : 0

Akurasi Estimator 8 : 0.7193
Prediksi Estimator 8 : 0

Akurasi Estimator 9 : 0.7737
Prediksi Estimator 9 : 0

Akurasi Estimator 10 : 0.6877
Prediksi Estimator 10 : 0

Akurasi Estimator 11 : 0.7772
Prediksi Estimator 11 : 0

Akurasi Estimator 12 : 0.7193
Prediksi Estimator 12 : 0

Akurasi Estimator 13 : 0.7579
Prediksi Estimator 13 : 0

Akurasi Estimator 14 : 0.7298
Prediksi Estimator 14 : 0

Akurasi Estimator 15 : 0.7754
Prediksi Estimator 15 : 0

Akurasi Estimator 16 : 0.7930
Prediksi Estimator 16 : 0

Akurasi Estimator 17 : 0.7333
Prediksi Estimator 17 : 0

Akurasi Estimator 18 : 0.7860
Prediksi Estimator 18 : 0

Akurasi Estimator 19 : 0.7491
Prediksi Estimator 19 : 0

Akurasi Estimator 20 : 0.7456
Prediksi Estimator 20 : 0

Prediksi mayoritas untuk data baru: 0
Jumlah prediksi untuk kelas 0: 20
Jumlah prediksi untuk kelas 1: 0
Akurasi rata-rata dari semua estimators: 0.7432
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/cabedf3e10d7d485a0d9b8faa6517c70eb2c47489998c8cd459e1713459e4c87.png"><img alt="_images/cabedf3e10d7d485a0d9b8faa6517c70eb2c47489998c8cd459e1713459e4c87.png" src="_images/cabedf3e10d7d485a0d9b8faa6517c70eb2c47489998c8cd459e1713459e4c87.png" style="width: 1001px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/9add6843fde3aa1e544f5b3860c3c485cc5bb7adf67973a24459c8972ce14d22.png"><img alt="_images/9add6843fde3aa1e544f5b3860c3c485cc5bb7adf67973a24459c8972ce14d22.png" src="_images/9add6843fde3aa1e544f5b3860c3c485cc5bb7adf67973a24459c8972ce14d22.png" style="width: 700px; height: 393px;" /></a>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="kesimpulan">
<h1>Kesimpulan<a class="headerlink" href="#kesimpulan" title="Link to this heading">#</a></h1>
<p>Dari ketiga model yang sudah saya buat, memiliki akurasi sebagai berikut :</p>
<ul class="simple">
<li><p>single model dengan GNB : mendapatkan akurasi 76,14%</p></li>
</ul>
<ul class="simple">
<li><p>stacking dengan KNN dan GNB : mendapatkan akurasi 73,51%</p></li>
</ul>
<ul class="simple">
<li><p>bagging dengan GNB : mendapatkan akurasi 74,32%</p></li>
</ul>
<p>Dapat disimpulkan bahwa single model dengan GNB merupakan model terbaik karena memiliki akurasi yang paling tertinggi dari ketiga model yang sudah dibuat dengan akurasi 76,14%. Untuk tahap implementasi menggunakan model terbaik yaitu single model dengan GNB.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="implementasi-model">
<h1>Implementasi Model<a class="headerlink" href="#implementasi-model" title="Link to this heading">#</a></h1>
<p>Pada tahap ini, saya akan mengimplementasikan model menggunakan Gaussian Naive Bayes (GNB) sebagai alat untuk mengklasifikasikan churn. Tujuan implementasi ini adalah mengembangkan model klasifikasi yang dapat memprediksi perilaku churn pelanggan dan menyediakan wawasan yang berguna bagi perusahaan dalam meningkatkan strategi retensi pelanggan mereka.</p>
<p>Saya memilih menggunakan Python dengan framework Flask untuk pengembangan ini. Penggunaan Flask memungkinkan saya untuk membuat aplikasi yang ringan dan dapat dijalankan dengan mudah, serta memanfaatkan kemampuan Flask dalam menangani permintaan web dan menyajikan hasil prediksi dari model GNB secara efektif.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="implementasi-web">
<h1>Implementasi Web<a class="headerlink" href="#implementasi-web" title="Link to this heading">#</a></h1>
<p>Tahapan implementasi flask untuk prediksi class iranian churn</p>
<ol class="arabic simple">
<li><p>Mengimpor library yang diperlukan</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Menginisialisasi aplikasi flask</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Memuat dan melatih model</p></li>
</ol>
<ol class="arabic simple" start="4">
<li><p>Mendefinisikan rute utama dan logika prediksi</p></li>
</ol>
<ol class="arabic simple" start="5">
<li><p>Menjalankan aplikasi</p></li>
</ol>
<p>Berikut adalah link implementasi yang sudah saya upload di github :</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hasil-implementasi-web">
<h1>Hasil Implementasi Web<a class="headerlink" href="#hasil-implementasi-web" title="Link to this heading">#</a></h1>
<p>Link website : <a class="reference external" href="https://tasyadwiyanti.pythonanywhere.com/">https://tasyadwiyanti.pythonanywhere.com/</a></p>
<p>Hasil Deploying Tampilan Aplikasi :</p>
<img src="image-20240626-233713.png" width="" align="" /><p>Disini saya tes untuk prediksinya, saya masukkan inputan [10, 0, 35, 0, 3225, 71, 5, 17, 3, 1, 1, 30, 945.44]</p>
<img src="image-20240626-234012.png" width="" align="" /><img src="image-20240627-000433.png" width="" align="" /><p>Berdasarkan hasil model terbaik yang saya gunakan kedalam implementasi sudah sangat sesuai hasilnya yaitu termasuk class 0, maka implementasi yang saya buat sudah berhasil berjalan sesuai dengan model terbaik yaitu GNB dengan akurasi 76.14%.</p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=23905452-9db2-4401-b17a-b0565c5b6809' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1. Analisis dan Implementasi Klasifikasi Churn Pelanggan pada Perusahaan Telekomunikasi Iranian</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-dalam-bidang-analisis-data-telekomunikasi">Tujuan dalam Bidang Analisis Data Telekomunikasi</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konteks-penelitian">Konteks Penelitian</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">2. Data Understanding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pengumpulan-data">Pengumpulan Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mencari-dataset">Mencari Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengambil-dan-menampilkan-dataset">Mengambil dan Menampilkan Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memahami-data">Memahami Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">Eksplorasi Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumlah-data-fitur-dan-tipe-data">Jumlah Data Fitur dan Tipe Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumlah-data-dari-dataset-iranian-churn">Jumlah Data dari Dataset Iranian Churn</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumlah-class-atau-kategori-pada-data-iranian-churn">Jumlah Class atau Kategori pada Data Iranian Churn</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deskripsi-dataset">Deskripsi Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifikasi-kualitas-data">Identifikasi Kualitas Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-data-missing-values">1. Deteksi Data Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-data-outlier">2. Deteksi Data Outlier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-duplikasi-dataset">3. Deteksi Duplikasi Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prepocessing-data">3. Prepocessing Data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">4. Modelling</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-metode-klasifikasi-naive-bayes">Implementasi Metode Klasifikasi Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membagi-data-train-dan-data-test">Membagi Data Train dan Data Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melakukan-prediksi-dengan-sklearn-naive-bayes">Melakukan Prediksi dengan Sklearn Naive Bayes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-learning">Ensemble Learning</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-classifier-meta-classifier">Stacking Classifier (Meta Classifier)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-meta-predict-classifier-model-naive-bayes-manual">A. Meta Predict Classifier Model Naive Bayes Manual</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-p1">Model P1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-p2">Model P2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bagging">Bagging</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#kesimpulan">Kesimpulan</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-model">Implementasi Model</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-web">Implementasi Web</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hasil-implementasi-web">Hasil Implementasi Web</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>